# TASK-303: GitHub API 클라이언트 테스트 케이스

## 1. GitHubApiClient 클래스 테스트

### 1.1 Repository 정보 조회

#### TC-303-001: 유효한 Repository 조회
- **입력**: `owner: 'microsoft', repo: 'vscode'`
- **예상 결과**: Repository 객체 반환
- **검증**:
  - name: 'vscode'
  - fullName: 'microsoft/vscode'
  - description 존재
  - language 정보 존재

#### TC-303-002: 존재하지 않는 Repository
- **입력**: `owner: 'nonexistent', repo: 'repo'`
- **예상 결과**: NOT_FOUND 에러 발생
- **검증**: GitHubApiError 타입의 예외

#### TC-303-003: Private Repository 접근 (권한 없음)
- **입력**: Private repository 정보
- **예상 결과**: AUTH_ERROR 타입 에러
- **검증**: 403 상태 코드

### 1.2 Issue 정보 조회

#### TC-303-004: 유효한 Issue 조회
- **입력**: `owner: 'microsoft', repo: 'vscode', number: 1`
- **예상 결과**: Issue 객체 반환
- **검증**:
  - number: 1
  - title 존재
  - state: 'open' | 'closed'
  - author 정보 존재

#### TC-303-005: 존재하지 않는 Issue
- **입력**: `number: 999999999`
- **예상 결과**: NOT_FOUND 에러
- **검증**: 404 상태 코드

#### TC-303-006: Issue 상세 정보 검증
- **입력**: 유효한 Issue 번호
- **예상 결과**: 모든 필드 존재
- **검증**:
  - labels 배열
  - assignees 배열
  - 날짜 필드들 (Date 타입)

### 1.3 Pull Request 정보 조회

#### TC-303-007: 유효한 PR 조회
- **입력**: 유효한 PR 번호
- **예상 결과**: PullRequest 객체 반환
- **검증**:
  - Issue 필드들 모두 포함
  - headBranch, baseBranch 존재
  - commits, additions, deletions 숫자

#### TC-303-008: PR 고유 필드 검증
- **입력**: 유효한 PR 번호
- **예상 결과**: PR 전용 필드 존재
- **검증**:
  - mergeable boolean
  - merged boolean
  - changedFiles 숫자

#### TC-303-009: Merged PR 정보
- **입력**: 병합된 PR 번호
- **예상 결과**: 병합 정보 포함
- **검증**:
  - merged: true
  - mergedAt 날짜 존재

### 1.4 파일 및 변경사항

#### TC-303-010: 파일 내용 조회
- **입력**: `path: 'package.json'`
- **예상 결과**: FileContent 객체
- **검증**:
  - content 문자열 존재
  - encoding 정보
  - size 정보

#### TC-303-011: 존재하지 않는 파일
- **입력**: `path: 'nonexistent.txt'`
- **예상 결과**: NOT_FOUND 에러
- **검증**: 404 상태 코드

#### TC-303-012: PR 파일 변경사항
- **입력**: 유효한 PR 번호
- **예상 결과**: FileChange 배열
- **검증**:
  - 각 파일의 status (added/modified/deleted)
  - additions, deletions 정보
  - filename 정보

#### TC-303-013: 대용량 파일 처리
- **입력**: 큰 파일 경로
- **예상 결과**: 적절한 처리 또는 에러
- **검증**: 타임아웃 또는 크기 제한 에러

### 1.5 댓글 및 리뷰

#### TC-303-014: Issue 댓글 조회
- **입력**: 댓글이 있는 Issue 번호
- **예상 결과**: Comment 배열
- **검증**:
  - 각 댓글의 body, author
  - 생성/수정 날짜
  - 정렬 순서 (오래된 순)

#### TC-303-015: 댓글 없는 Issue
- **입력**: 댓글 없는 Issue 번호
- **예상 결과**: 빈 배열
- **검증**: length === 0

#### TC-303-016: PR 리뷰 조회
- **입력**: 리뷰가 있는 PR 번호
- **예상 결과**: Review 배열
- **검증**:
  - 리뷰어 정보
  - 리뷰 상태 (approved/changes_requested/commented)
  - 리뷰 본문

## 2. GitHubDataMapper 클래스 테스트

### 2.1 데이터 변환

#### TC-303-017: Repository 데이터 매핑
- **입력**: GitHub API Repository 응답
- **예상 결과**: 내부 Repository 모델
- **검증**:
  - 필드명 정규화
  - 날짜 객체 변환
  - 타입 안전성

#### TC-303-018: Issue 데이터 매핑
- **입력**: GitHub API Issue 응답
- **예상 결과**: 내부 Issue 모델
- **검증**:
  - 중첩 객체 처리 (author, labels)
  - null 값 처리
  - enum 값 검증

#### TC-303-019: PullRequest 데이터 매핑
- **입력**: GitHub API PR 응답
- **예상 결과**: 내부 PullRequest 모델
- **검증**:
  - Issue 필드 상속
  - PR 전용 필드 추가
  - 옵셔널 필드 처리

### 2.2 데이터 검증

#### TC-303-020: 필수 필드 검증
- **입력**: 필수 필드 누락된 응답
- **예상 결과**: 검증 에러
- **검증**: 구체적인 에러 메시지

#### TC-303-021: 타입 검증
- **입력**: 잘못된 타입의 응답 데이터
- **예상 결과**: 타입 에러
- **검증**: 타입 안전성 보장

#### TC-303-022: 날짜 형식 검증
- **입력**: 다양한 날짜 형식
- **예상 결과**: Date 객체로 변환
- **검증**: 유효한 Date 인스턴스

## 3. GitHubRateLimitManager 클래스 테스트

### 3.1 Rate Limit 추적

#### TC-303-023: 초기 Rate Limit 상태
- **입력**: 새로운 매니저 인스턴스
- **예상 결과**: 기본 제한값 설정
- **검증**:
  - remaining: 5000
  - resetTime 설정
  - 추적 기능 활성화

#### TC-303-024: API 호출 후 상태 업데이트
- **입력**: API 응답 헤더
- **예상 결과**: Rate Limit 정보 업데이트
- **검증**:
  - remaining 감소
  - resetTime 업데이트
  - 정확한 카운팅

#### TC-303-025: Rate Limit 임계값 감지
- **입력**: remaining < 100
- **예상 결과**: 경고 발생
- **검증**: 임계값 이벤트 트리거

### 3.2 대기 시간 계산

#### TC-303-026: Rate Limit 초과 시 대기 시간
- **입력**: remaining: 0
- **예상 결과**: resetTime까지 대기 시간 계산
- **검증**: 초 단위 정확한 계산

#### TC-303-027: 여유 있는 상태의 대기 시간
- **입력**: remaining: 1000
- **예상 결과**: 대기 불필요
- **검증**: 0 또는 최소 대기 시간

#### TC-303-028: 백오프 전략 적용
- **입력**: 연속된 Rate Limit 초과
- **예상 결과**: 지수적 백오프
- **검증**: 대기 시간 증가 패턴

## 4. 에러 처리 테스트

### 4.1 인증 에러

#### TC-303-029: 잘못된 토큰
- **입력**: 유효하지 않은 토큰
- **예상 결과**: AUTH_ERROR 타입 에러
- **검증**:
  - status: 401
  - type: 'AUTH_ERROR'
  - 명확한 에러 메시지

#### TC-303-030: 토큰 없음
- **입력**: 토큰 미제공
- **예상 결과**: AUTH_ERROR 에러
- **검증**: 인증 필요 메시지

#### TC-303-031: 권한 부족
- **입력**: 읽기 권한 없는 리소스
- **예상 결과**: AUTH_ERROR (403)
- **검증**: 권한 부족 메시지

### 4.2 API 에러

#### TC-303-032: Rate Limit 초과
- **입력**: 제한 초과 상황
- **예상 결과**: RATE_LIMIT 에러
- **검증**:
  - retryAfter 시간 포함
  - 정확한 대기 시간

#### TC-303-033: 서버 오류 (500)
- **입력**: GitHub 서버 오류
- **예상 결과**: UNKNOWN 타입 에러
- **검증**: 재시도 가능 표시

#### TC-303-034: 네트워크 타임아웃
- **입력**: 응답 지연
- **예상 결과**: NETWORK_ERROR
- **검증**: 타임아웃 설정 준수

### 4.3 재시도 로직

#### TC-303-035: 자동 재시도 (500 에러)
- **입력**: 서버 오류 응답
- **예상 결과**: 자동 재시도 후 성공
- **검증**: 재시도 횟수 추적

#### TC-303-036: 재시도 제한
- **입력**: 연속된 실패
- **예상 결과**: 최대 재시도 후 포기
- **검증**: 최종 에러 반환

#### TC-303-037: 백오프 지연
- **입력**: 재시도 상황
- **예상 결과**: 지수적 지연 적용
- **검증**: 대기 시간 패턴

## 5. 통합 테스트

### 5.1 전체 플로우

#### TC-303-038: Repository 분석 플로우
- **입력**: Repository 정보
- **예상 결과**: 전체 데이터 수집 성공
- **검증**:
  1. Repository 메타데이터
  2. Issue/PR 목록
  3. 파일 구조
  4. 댓글/리뷰 데이터

#### TC-303-039: Issue 상세 분석
- **입력**: Issue 번호
- **예상 결과**: 완전한 Issue 정보
- **검증**:
  - Issue 기본 정보
  - 모든 댓글
  - 연관 파일 (있는 경우)

#### TC-303-040: PR 변경사항 분석
- **입력**: PR 번호
- **예상 결과**: 완전한 변경사항 정보
- **검증**:
  - PR 메타데이터
  - 파일 변경사항
  - 리뷰 데이터
  - 커밋 정보

### 5.2 성능 테스트

#### TC-303-041: 대용량 Repository 처리
- **입력**: 큰 Repository (1000+ files)
- **예상 결과**: 효율적 처리
- **검증**:
  - 메모리 사용량 모니터링
  - 응답 시간 측정
  - 정확성 보장

#### TC-303-042: 동시 API 호출
- **입력**: 10개 병렬 요청
- **예상 결과**: 모든 요청 성공
- **검증**:
  - Rate Limit 준수
  - 데이터 정확성
  - 에러 없음

#### TC-303-043: 장시간 실행 테스트
- **입력**: 1시간 연속 호출
- **예상 결과**: 안정적 동작
- **검증**:
  - 메모리 누수 없음
  - Rate Limit 관리
  - 에러 처리

### 5.3 실제 환경 테스트

#### TC-303-044: Public Repository 테스트
- **입력**: 실제 오픈소스 프로젝트
- **예상 결과**: 정상 데이터 수집
- **검증**: 실제 GitHub와 일치

#### TC-303-045: Private Repository 테스트
- **입력**: 접근 권한 있는 Private repo
- **예상 결과**: 정상 접근 및 데이터 수집
- **검증**: 권한 확인 및 데이터 보안

#### TC-303-046: 다양한 언어 Repository
- **입력**: TypeScript, Python, Java 등
- **예상 결과**: 언어별 특성 정확히 반영
- **검증**: 언어 감지 정확성

## 6. 모킹 테스트

### 6.1 API 응답 모킹

#### TC-303-047: 성공 응답 모킹
- **입력**: 모킹된 성공 응답
- **예상 결과**: 정상 처리
- **검증**: 실제 API와 동일한 동작

#### TC-303-048: 에러 응답 모킹
- **입력**: 다양한 HTTP 에러 코드
- **예상 결과**: 적절한 에러 처리
- **검증**: 에러 타입 분류 정확성

#### TC-303-049: 부분 데이터 응답
- **입력**: 일부 필드 누락 응답
- **예상 결과**: 견고한 처리
- **검증**: 기본값 또는 에러 처리

### 6.2 네트워크 상황 시뮬레이션

#### TC-303-050: 느린 네트워크
- **입력**: 지연된 응답
- **예상 결과**: 타임아웃 처리
- **검증**: 설정된 시간 내 타임아웃

#### TC-303-051: 불안정한 연결
- **입력**: 간헐적 연결 실패
- **예상 결과**: 재시도 후 성공
- **검증**: 복원력 있는 처리

#### TC-303-052: 완전한 네트워크 단절
- **입력**: 연결 불가능
- **예상 결과**: NETWORK_ERROR
- **검증**: 명확한 에러 메시지