# TASK-302: Slack 명령어 처리기 테스트 케이스

## 1. CommandParser 클래스 테스트

### 1.1 GitHub URL 파싱

#### TC-302-001: 유효한 Issue URL 파싱
- **입력**: `https://github.com/owner/repo/issues/123`
- **예상 결과**: URL 정보 정확히 추출
- **검증**:
  - owner: 'owner'
  - repo: 'repo'
  - type: 'issue'
  - number: 123

#### TC-302-002: 유효한 PR URL 파싱
- **입력**: `https://github.com/owner/repo/pull/456`
- **예상 결과**: URL 정보 정확히 추출
- **검증**:
  - owner: 'owner'
  - repo: 'repo'
  - type: 'pr'
  - number: 456

#### TC-302-003: 잘못된 URL 처리
- **입력**: `https://invalid-url.com/test`
- **예상 결과**: 검증 실패
- **검증**: isValid: false, errors 배열에 에러 메시지

### 1.2 옵션 파라미터 파싱

#### TC-302-004: 기본 옵션 파싱
- **입력**: `--type=issue --depth=5`
- **예상 결과**: 옵션 객체 생성
- **검증**:
  - type: 'issue'
  - depth: 5
  - format: 'markdown' (기본값)

#### TC-302-005: 모든 옵션 파싱
- **입력**: `--type=pr --depth=10 --format=json --include-tests`
- **예상 결과**: 모든 옵션 설정
- **검증**:
  - type: 'pr'
  - depth: 10
  - format: 'json'
  - includeTests: true

#### TC-302-006: 잘못된 옵션 값
- **입력**: `--type=invalid --depth=abc`
- **예상 결과**: 검증 에러
- **검증**: errors 배열에 구체적인 에러 메시지

### 1.3 복합 명령어 파싱

#### TC-302-007: URL + 옵션 복합 파싱
- **입력**: `https://github.com/owner/repo/issues/123 --depth=5 --format=json`
- **예상 결과**: URL과 옵션 모두 파싱
- **검증**: githubUrl과 options 모두 정확히 설정

#### TC-302-008: 공백과 순서 처리
- **입력**: `  --depth=3   https://github.com/test/repo/pull/1  --format=markdown  `
- **예상 결과**: 공백 제거하고 순서 무관하게 파싱
- **검증**: 정확한 파싱 결과

## 2. AnalysisRequestManager 클래스 테스트

### 2.1 요청 생성

#### TC-302-009: 기본 분석 요청 생성
- **입력**: 유효한 GitHub URL과 옵션
- **예상 결과**: AnalysisRequest 객체 생성
- **검증**:
  - 고유 ID 생성
  - 현재 시간 설정
  - 상태: 'pending'

#### TC-302-010: 요청 ID 유일성
- **입력**: 동일한 URL로 여러 요청
- **예상 결과**: 각각 다른 ID 생성
- **검증**: 모든 ID가 고유함

### 2.2 상태 관리

#### TC-302-011: 상태 업데이트
- **입력**: 요청 ID와 새로운 상태
- **예상 결과**: 상태 변경 및 시간 기록
- **검증**:
  - 상태 정확히 변경
  - 완료 시간 기록 (completed 상태일 때)

#### TC-302-012: 존재하지 않는 요청 처리
- **입력**: 잘못된 요청 ID
- **예상 결과**: 에러 발생
- **검증**: 적절한 에러 메시지

### 2.3 요청 조회

#### TC-302-013: 사용자별 요청 조회
- **입력**: 사용자 ID
- **예상 결과**: 해당 사용자의 모든 요청
- **검증**: 정확한 필터링

#### TC-302-014: 상태별 요청 조회
- **입력**: 상태 ('pending', 'processing' 등)
- **예상 결과**: 해당 상태의 요청들만 반환
- **검증**: 상태 필터링 정확성

## 3. SlackCommandHandler 클래스 테스트

### 3.1 명령어 처리

#### TC-302-015: 기본 analyze-repo 명령어
- **입력**: `/analyze-repo https://github.com/owner/repo/issues/123`
- **예상 결과**: 즉시 응답 메시지 생성
- **검증**:
  - response_type: 'ephemeral'
  - 시작 메시지 포함
  - 분석 요청 생성됨

#### TC-302-016: 옵션이 포함된 명령어
- **입력**: `/analyze-repo https://github.com/owner/repo/pull/456 --depth=5`
- **예상 결과**: 옵션이 반영된 응답
- **검증**: 응답 메시지에 옵션 정보 포함

#### TC-302-017: 도움말 명령어
- **입력**: `/analyze-repo help` 또는 `/analyze-repo --help`
- **예상 결과**: 도움말 메시지 반환
- **검증**: 사용법과 예시 포함

### 3.2 에러 처리

#### TC-302-018: 잘못된 URL 에러
- **입력**: `/analyze-repo invalid-url`
- **예상 결과**: 에러 메시지 응답
- **검증**:
  - 에러 설명
  - 올바른 형식 안내
  - response_type: 'ephemeral'

#### TC-302-019: 필수 파라미터 누락
- **입력**: `/analyze-repo`
- **예상 결과**: 사용법 안내 메시지
- **검증**: 도움말 메시지 표시

#### TC-302-020: 권한 부족 에러
- **입력**: Private 리포지토리 URL
- **예상 결과**: 권한 에러 메시지
- **검증**: 구체적인 권한 안내

### 3.3 응답 형식

#### TC-302-021: 즉시 응답 형식 검증
- **입력**: 유효한 명령어
- **예상 결과**: 올바른 Slack 응답 형식
- **검증**:
  - text 필드 존재
  - 적절한 이모지 사용
  - 읽기 쉬운 형식

#### TC-302-022: 블록 형식 응답
- **입력**: 복잡한 정보가 포함된 응답
- **예상 결과**: Slack 블록 형식 사용
- **검증**: blocks 배열 구조 정확성

## 4. 통합 테스트

### 4.1 전체 명령어 플로우

#### TC-302-023: 성공적인 분석 요청 플로우
- **입력**: 완전한 analyze-repo 명령어
- **예상 결과**: 전체 프로세스 성공
- **검증**:
  1. 명령어 파싱 성공
  2. 분석 요청 생성
  3. 즉시 응답 전송
  4. 백그라운드 작업 시작

#### TC-302-024: 다중 사용자 동시 요청
- **입력**: 여러 사용자의 동시 명령어
- **예상 결과**: 모든 요청 정상 처리
- **검증**: 각 요청이 독립적으로 처리

### 4.2 Slack 통합

#### TC-302-025: Slack 슬래시 명령어 등록
- **입력**: Slack 슬래시 명령어 설정
- **예상 결과**: 명령어가 Slack에 등록됨
- **검증**: 실제 Slack에서 명령어 실행 가능

#### TC-302-026: 스레드 응답 처리
- **입력**: 스레드 내에서 명령어 실행
- **예상 결과**: 같은 스레드에 응답
- **검증**: thread_ts 설정 정확성

## 5. 성능 테스트

### 5.1 응답 시간

#### TC-302-027: 명령어 파싱 속도
- **입력**: 복잡한 명령어 1000개
- **예상 결과**: 평균 100ms 이내 파싱
- **검증**: 응답 시간 측정

#### TC-302-028: 즉시 응답 속도
- **입력**: 다양한 명령어
- **예상 결과**: 500ms 이내 응답 생성
- **검증**: 응답 생성 시간 측정

### 5.2 동시 처리

#### TC-302-029: 동시 요청 처리 능력
- **입력**: 50개 동시 명령어
- **예상 결과**: 모든 요청 정상 처리
- **검증**:
  - 요청 손실 없음
  - 메모리 사용량 안정
  - 응답 시간 유지

#### TC-302-030: 메모리 사용량
- **입력**: 대량 요청 처리
- **예상 결과**: 메모리 누수 없음
- **검증**: 처리 후 메모리 회수

## 6. 에러 시나리오 테스트

### 6.1 네트워크 에러

#### TC-302-031: GitHub API 접근 불가
- **입력**: GitHub 서비스 다운 시뮬레이션
- **예상 결과**: 적절한 에러 처리
- **검증**: 사용자에게 재시도 안내

#### TC-302-032: 타임아웃 처리
- **입력**: 응답 시간이 긴 요청
- **예상 결과**: 타임아웃 에러 처리
- **검증**: 적절한 에러 메시지

### 6.2 시스템 리소스 부족

#### TC-302-033: 큐 시스템 오버플로우
- **입력**: 처리 한계를 초과하는 요청
- **예상 결과**: 대기열 관리 또는 거부
- **검증**: 시스템 안정성 유지

#### TC-302-034: 데이터베이스 연결 실패
- **입력**: DB 접근 불가 상황
- **예상 결과**: 임시 저장 또는 에러 처리
- **검증**: 서비스 중단 최소화