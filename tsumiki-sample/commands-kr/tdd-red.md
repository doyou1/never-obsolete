# TDD Red 페이즈 (실패하는 테스트를 작성)

TDD의 Red 페이즈를 실행합니다.

## 사전 준비

개발 컨텍스트의 준비를 수행합니다:

**Task 도구 실행**: `/tdd-load-context`로 TDD 관련 파일의 읽기와 컨텍스트 준비를 실행

읽기 완료 후, 준비된 컨텍스트 정보를 기반으로 Red 페이즈(실패 테스트 작성)의 작업을 시작합니다.

## 대상 테스트 케이스

**【대상 테스트 케이스】**: {{test_case_name}}

## 신뢰성 레벨 지시

테스트 코드 작성 시에는, 각 테스트 케이스의 내용에 대해 원래 자료와의 대조 상황을 다음의 신호로 표시해 주세요:

- 🟢 **청신호**: 원래 자료를 참고해서 거의 추측하지 않은 경우
- 🟡 **황신호**: 원래 자료로부터 타당한 추측인 경우
- 🔴 **적신호**: 원래 자료에 없는 추측인 경우

## 요구사항

- **사용 언어/프레임워크**: {{language_framework}}
- 테스트는 반드시 실패하는 상태로 작성
- 테스트명은 이해하기 쉽게 일본어로 기재
- 어서션(기대값의 검증)을 명확히 기재
- 아직 구현되지 않은 함수·메서드를 호출하는 형태로 작성

## 테스트 코드 작성 지침

- Given-When-Then 패턴을 의식한 구조
- 테스트 데이터의 준비(Given)
- 실제 처리의 실행(When)
- 결과의 검증(Then)

## 일본어 코멘트 필수 요구사항

테스트 코드에는 다음의 일본어 코멘트를 반드시 포함해 주세요:

### 테스트 케이스 시작 시의 코멘트

```javascript
describe('{{feature_name}}', () => {
  test('{{test_case_name}}', () => {
    // 【테스트 목적】: [이 테스트로 무엇을 확인하는지를 일본어로 명기]
    // 【테스트 내용】: [구체적으로 어떤 처리를 테스트하는지를 설명]
    // 【기대되는 동작】: [정상적으로 동작했을 경우의 결과를 설명]
    // 🟢🟡🔴 신뢰성 레벨: [이 테스트의 내용이 원 자료의 어느 정도에 기반하고 있는지]

    // 【테스트 데이터 준비】: [왜 이 데이터를 준비하는지의 이유]
    // 【초기 조건 설정】: [테스트 실행 전의 상태를 설명]
    const input = {{test_input}};

    // 【실제의 처리 실행】: [어떤 기능/메서드를 호출하는지를 설명]
    // 【처리 내용】: [실행되는 처리의 내용을 일본어로 설명]
    const result = {{function_name}}(input);

    // 【결과 검증】: [무엇을 검증하는지를 구체적으로 설명]
    // 【기대값 확인】: [기대되는 결과와 그 이유를 설명]
    expect(result).toBe({{expected_output}}); // 【확인 내용】: [이 검증으로 확인하고 있는 구체적인 항목] 🟢🟡🔴
  });
});
```

### 셋업·클린업의 코멘트(필요에 따라)

```javascript
beforeEach(() => {
  // 【테스트 전 준비】: [각 테스트 실행 전에 수행하는 준비 작업의 설명]
  // 【환경 초기화】: [테스트 환경을 클린한 상태로 하는 이유와 방법]
});

afterEach(() => {
  // 【테스트 후 처리】: [각 테스트 실행 후에 수행하는 클린업 작업의 설명]
  // 【상태 복원】: [다음 테스트에 영향을 주지 않도록 상태를 복원하는 이유]
});
```

### 각 expect 스테이트먼트의 코멘트

각 expect 스테이트먼트에는 반드시 일본어 코멘트를 붙여 주세요:

```javascript
expect(result.property).toBe(expectedValue); // 【확인 내용】: [이 검증으로 확인하고 있는 구체적인 항목과 이유]
expect(result.array).toHaveLength(3); // 【확인 내용】: [배열의 길이가 기대값과 일치하는 것을 확인하는 이유]
expect(result.errors).toContain('error message'); // 【확인 내용】: [특정의 에러 메시지가 포함되는 것을 확인하는 이유]
```

## 작성하는 테스트 코드의 예

```javascript
// 테스트 파일: {{test_file_name}}
describe('{{feature_name}}', () => {
  beforeEach(() => {
    // 【테스트 전 준비】: 각 테스트 실행 전에 테스트 환경을 초기화하고, 일관된 테스트 조건을 보장
    // 【환경 초기화】: 이전 테스트의 영향을 받지 않도록, 파일 시스템의 상태를 클린하게 리셋
  });

  afterEach(() => {
    // 【테스트 후 처리】: 테스트 실행 후에 작성된 임시 파일이나 디렉토리를 삭제
    // 【상태 복원】: 다음 테스트에 영향을 주지 않도록, 시스템을 원래 상태로 되돌림
  });

  test('{{test_case_name}}', () => {
    // 【테스트 목적】: {{test_purpose}}
    // 【테스트 내용】: {{test_description}}
    // 【기대되는 동작】: {{expected_behavior}}
    // 🟢🟡🔴 신뢰성 레벨: [이 테스트의 내용이 원 자료의 어느 정도에 기반하고 있는지]

    // 【테스트 데이터 준비】: {{test_data_reason}}
    // 【초기 조건 설정】: {{initial_condition}}
    const input = {{test_input}};

    // 【실제의 처리 실행】: {{function_description}}
    // 【처리 내용】: {{process_description}}
    const result = {{function_name}}(input);

    // 【결과 검증】: {{verification_description}}
    // 【기대값 확인】: {{expected_result_reason}}
    expect(result).toBe({{expected_output}}); // 【확인 내용】: {{specific_verification_point}}
  });
});
```

## 제공해 주세요

1. **테스트 코드**: 실행 가능한 형태로, 필수의 일본어 코멘트 부착
2. **테스트 실행 커맨드**: 어떻게 실행하는지
3. **기대되는 실패 메시지**: 어떤 에러가 나오는지
4. **코멘트의 설명**: 각 일본어 코멘트의 의도와 목적

테스트 코드 작성 후, 다음을 실행해 주세요:

1. **메모 파일 작성·업데이트**: docs/implements/{{task_id}}/{feature_name}-memo.md 파일에 Red 페이즈의 내용을 작성 또는 추가
   - 기존의 메모 파일이 있는 경우는, Red 페이즈 섹션을 업데이트
   - 메모 파일이 존재하지 않는 경우는 신규 작성
2. 테스트 코드의 설계 내용을 docs/implements/{{task_id}}/{feature_name}-red-phase.md에 저장(기존 파일이 있는 경우는 추가)
3. TODO 상태를 업데이트(Red 페이즈 완료를 마크)
4. **품질 판정**: 테스트 코드의 품질을 다음의 기준으로 판정
   - 테스트 실행: 실행 가능하고 실패하는 것을 확인 완료
   - 기대값: 명확하고 구체적
   - 어서션: 적절
   - 구현 방침: 명확
5. **다음 스텝 표시**: 판정 결과에 관계없이, 다음의 권장 커맨드를 표시
   - 「다음의 권장 스텝: `/tdd-green`으로 Green 페이즈(최소 구현)를 시작합니다.」

## TDD 메모 파일 형태

docs/implements/{{task_id}}/{feature_name}-memo.md 파일의 형태:

```markdown
# TDD 개발 메모: {feature_name}

## 개요

- 기능명: [기능명]
- 개발 시작: [일시]
- 현재의 페이즈: [Red/Green/Refactor]

## 관련 파일

- 요구사항 정의: `docs/implements/{{task_id}}/{feature_name}-requirements.md`
- 테스트 케이스 정의: `docs/implements/{{task_id}}/{feature_name}-testcases.md`
- 구현 파일: `[구현 파일의 경로]`
- 테스트 파일: `[테스트 파일의 경로]`

## Red 페이즈(실패하는 테스트 작성)

### 작성 일시

[일시]

### 테스트 케이스

[작성한 테스트 케이스의 개요]

### 테스트 코드

[실제의 테스트 코드]

### 기대되는 실패

[어떤 실패가 기대되는지]

### 다음 페이즈에의 요구사항

[Green 페이즈에서 구현해야 할 내용]

## Green 페이즈(최소 구현)

### 구현 일시

[일시]

### 구현 방침

[최소 구현의 방침]

### 구현 코드

[실제의 구현 코드]

### 테스트 결과

[테스트가 통과한 결과]

### 과제·개선점

[Refactor 페이즈에서 개선해야 할 점]

## Refactor 페이즈(품질 개선)

### 리팩터 일시

[일시]

### 개선 내용

[구체적인 개선 내용]

### 보안 리뷰

[보안 면에서의 확인 결과]

### 퍼포먼스 리뷰

[퍼포먼스 면에서의 확인 결과]

### 최종 코드

[리팩터 후의 코드]

### 품질 평가

[최종적인 품질 평가]
```

## 품질 판정 기준

```
✅ 고품질:
- 테스트 실행: 성공(실패하는 것을 확인)
- 기대값: 명확하고 구체적
- 어서션: 적절
- 구현 방침: 명확

⚠️ 개선 필요:
- 테스트가 실행할 수 없음
- 기대값이 애매함
- 구현 접근법이 불명
- 복잡한 테스트 케이스
```

## TODO 업데이트 패턴

```
- 현재의 TODO「Red 페이즈(실패 테스트 작성)」를「completed」로 마크
- 실패 테스트 작성 페이즈의 완료를 TODO 내용에 반영
- 품질 판정 결과를 TODO 내용에 기록
- 다음의 페이즈「Green 페이즈(최소 구현)」를 TODO에 추가
```

다음 스텝: `/tdd-green`으로 테스트를 통과시키기 위한 최소한의 구현을 수행합니다.
